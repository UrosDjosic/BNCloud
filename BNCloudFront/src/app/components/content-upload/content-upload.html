<div class="upload-container">
  <mat-card class="upload-card">
    <h2 class="title">Upload Songs</h2>

    <div *ngFor="let song of uploads; let i = index" class="song-upload">
      <h3>Song {{ i + 1 }}</h3>

      <!-- Audio File Upload (no mat-form-field) -->
      <div class="file-input">
        <label>Audio File:</label>
        <input type="file" (change)="onFileSelected($event, i)" accept="audio/*" />
      </div>

      <div *ngIf="song.fileName" class="file-info">
        <p><strong>File Name:</strong> {{ song.fileName }}</p>
        <p><strong>Type:</strong> {{ song.fileType }}</p>
        <p><strong>Size:</strong> {{ (song.fileSize || 0) / 1000 | number:'1.0-0' }} KB</p>
        <p><strong>Modified:</strong> {{ song.modificationTime | date:'short' }}</p>
      </div>

      <br>

      <!-- Song Name -->
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Song Title</mat-label>
        <input matInput [(ngModel)]="song.name" placeholder="e.g. Lost in Sound" />
      </mat-form-field>

      <!-- Genres -->
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Genres (comma-separated)</mat-label>
        <input matInput [(ngModel)]="song.genresText" (blur)="updateGenres(i)" placeholder="e.g. Rock, Pop" />
      </mat-form-field>

      <!-- Artist Dropdown -->
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Artists</mat-label>
        <mat-select multiple [(ngModel)]="song.artists">
          <mat-option *ngFor="let artist of artists" [value]="artist.id">
            {{ artist.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <br>

      <!-- Cover Image Upload (no mat-form-field) -->
      <div class="file-input">
        <label>Cover Image:</label>
        <input type="file" (change)="onImageSelected($event, i)" accept="image/*" />
      </div>

      <div *ngIf="song.imagePreview" class="image-preview">
        <img [src]="song.imagePreview" alt="Cover Preview" height="120" />
      </div>

      <!-- Remove Song -->
      <button mat-stroked-button color="warn" *ngIf="uploads.length > 1" (click)="removeSong(i)">
        Remove Song
      </button>

      <mat-divider></mat-divider>
    </div>

    <!-- Add Another Song -->
    <div class="actions">
      <button mat-stroked-button color="accent" (click)="addAnotherSong()">
        + Add Another Song
      </button>
    </div>

    <!-- Submit -->
    <div class="actions">
      <button mat-raised-button color="primary" (click)="submit()">
        Upload
      </button>
    </div>
  </mat-card>
</div>
